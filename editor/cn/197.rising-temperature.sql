-- 
--  
--  è¡¨ Weather 
-- 
--  
-- +---------------+---------+
-- | Column Name   | Type    |
-- +---------------+---------+
-- | id            | int     |
-- | recordDate    | date    |
-- | temperature   | int     |
-- +---------------+---------+
-- id æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®
-- è¯¥è¡¨åŒ…å«ç‰¹å®šæ—¥æœŸçš„æ¸©åº¦ä¿¡æ¯ 
-- 
--  
-- 
--  ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼Œæ¥æŸ¥æ‰¾ä¸ä¹‹å‰ï¼ˆæ˜¨å¤©çš„ï¼‰æ—¥æœŸç›¸æ¯”æ¸©åº¦æ›´é«˜çš„æ‰€æœ‰æ—¥æœŸçš„ id ã€‚ 
-- 
--  è¿”å›ç»“æœ ä¸è¦æ±‚é¡ºåº ã€‚ 
-- 
--  æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹ä¾‹ï¼š 
-- 
--  
-- Weather
-- +----+------------+-------------+
-- | id | recordDate | Temperature |
-- +----+------------+-------------+
-- | 1  | 2015-01-01 | 10          |
-- | 2  | 2015-01-02 | 25          |
-- | 3  | 2015-01-03 | 20          |
-- | 4  | 2015-01-04 | 30          |
-- +----+------------+-------------+
-- 
-- Result table:
-- +----+
-- | id |
-- +----+
-- | 2  |
-- | 4  |
-- +----+
-- 2015-01-02 çš„æ¸©åº¦æ¯”å‰ä¸€å¤©é«˜ï¼ˆ10 -> 25ï¼‰
-- 2015-01-04 çš„æ¸©åº¦æ¯”å‰ä¸€å¤©é«˜ï¼ˆ20 -> 30ï¼‰
--  
--  
--  
--  ğŸ‘ 187 ğŸ‘ 0

# è§£æ³•ä¸€
# åˆ©ç”¨ DATEDIFF æ¯”è¾ƒä¸¤ä¸ªæ—¥æœŸå·®å€¼ä¸º 1
SELECT
    Weather.id
FROM
    Weather
        JOIN
    Weather w ON DATEDIFF(Weather.recordDate, w.recordDate) = 1
        AND Weather.temperature > w.temperature
;

# è§£æ³•äºŒ
# é€Ÿåº¦æ›´å¿«äº›
SELECT
    A.id
FROM
    Weather A JOIN Weather B
ON (A.recordDate = DATE_ADD(B.recordDate, INTERVAL 1 DAY))
WHERE
    A.temperature > B.temperature
;